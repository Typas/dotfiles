%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% preamble.sty
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\fileversion{0.2}
\def\filedate{2022/3/29}

\typeout{-- Package: ``preamble'' \fileversion\space <\filedate> --}
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{preamble}[\filedate\space\fileversion]

% Options
\newif\ifpreamble@algo
\DeclareOption{algo}{\preamble@algotrue}

\newif\ifpreamble@code
\DeclareOption{code}{\preamble@codetrue}

\newif\ifpreamble@math
\DeclareOption{math}{\preamble@mathtrue}

\ProcessOptions\relax

% Load common use packages
\RequirePackage{xeCJK}
\RequirePackage{parskip}
\RequirePackage{fontspec}

% Common settings
\setmainfont{XITS}
\setsansfont{Fira Sans}
\setCJKmainfont{Noto Serif CJK TC} % xeCJK
\setCJKsansfont{Noto Sans CJK TC} % xeCJK
\setlength{\parskip}{.5em} % parskip
\setlength{\parindent}{2em} % parskip
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt
\linespread{1.36}

\@ifclassloaded{beamer} {
  \AtBeginSection{
    \begin{frame}
      \vfill
      \centering
      \begin{beamercolorbox}[sep=8pt,center,rounded=true]{title}
        \usebeamerfont{title}\insertsectionhead\par%
      \end{beamercolorbox}
      \vfill
    \end{frame}
  }
}

% Optional package loading
\ifpreamble@algo
\RequirePackage{preamble-algo}
\fi

\ifpreamble@code
\RequirePackage{preamble-code}
\fi

\ifpreamble@math
\RequirePackage{preamble-math}
\fi

% Terminator
\endinput
